# 多串口功能说明

## 功能概述

本版本新增了多串口管理功能，允许用户同时连接和管理多个串口设备。每个串口都有独立的控制界面和数据显示窗口。

## 主要功能

### 1. 串口信息区域

在数据源菜单区域，每添加一个串口就会显示一个串口信息区域，包含：

- **串口名称和状态**：显示串口名称和当前连接状态
- **查看接收信息按钮**：点击后打开独立的接收信息窗口
- **发送数据按钮**：点击后打开独立的发送数据窗口
- **断开/连接按钮**：点击后断开串口连接，按钮会变为"连接"，再次点击可重新连接
- **删除按钮**：点击后删除当前串口连接并移除串口信息区域

### 2. 接收信息窗口

每个串口都有独立的接收信息窗口，功能包括：

- **数据缓冲**：窗口未打开时接收的数据会存储在缓冲区中
- **完整数据显示**：窗口打开时会显示所有接收到的数据（包括缓冲的数据）
- **实时数据显示**：窗口打开后继续实时显示新接收的数据
- **暂停功能**：可以暂停数据显示刷新，方便查看历史数据
- **数据统计**：显示接收字节数（暂停时显示"已暂停"状态）
- **智能滚动**：暂停时不自动滚动，恢复时继续自动滚动
- **清空功能**：清空显示的数据和缓冲区

### 3. 发送数据窗口

每个串口都有独立的发送数据窗口，功能包括：

- **数据输入**：支持文本和十六进制数据输入
- **发送选项**：
  - 十六进制发送
  - 自动发送（可设置间隔时间）
- **发送控制**：
  - 单次发送
  - 开始/停止自动发送
  - 清空输入数据

## 使用方法

### 添加串口

1. 点击右侧菜单标题栏的 "+" 按钮
2. 在弹出的对话框中选择串口和波特率
3. 支持的波特率：9600, 19200, 38400, 57600, 115200, 230400, 460800, 921600
4. 点击"连接"按钮
5. 串口信息区域会出现在数据源菜单中

### 查看接收信息

1. 在串口信息区域点击"查看接收信息"按钮
2. 独立的接收信息窗口会打开
3. 窗口会显示从该串口接收到的所有数据（包括窗口未打开时接收的数据）
4. 窗口打开后会继续实时显示新接收的数据
5. 点击"暂停"按钮可以暂停数据显示刷新，方便查看历史数据
6. 点击"恢复"按钮恢复数据显示，暂停期间的数据会在恢复时显示
7. 可以拖动滚动条查看历史数据，暂停时滚动条不会自动跳到底部

### 发送数据

1. 在串口信息区域点击"发送数据"按钮
2. 独立的发送数据窗口会打开
3. 在文本框中输入要发送的数据
4. 选择发送选项（十六进制、自动发送等）
5. 点击"发送"按钮或"停止自动发送"按钮

### 断开串口连接

1. 在串口信息区域点击"断开"按钮
2. 系统会断开串口连接但保留串口信息区域
3. 按钮会变为"连接"状态，其他按钮会被禁用
4. 数据接收部分会暂停并显示"已断开"状态
5. 接收窗口会显示断开状态，暂停按钮会被禁用
6. 点击"连接"按钮可以重新连接串口来恢复数据接收

### 删除串口

1. 在串口信息区域点击"删除"按钮
2. 系统会自动断开串口连接
3. 串口信息区域会从界面中移除
4. 相关的接收和发送窗口也会自动关闭

### 管理多个串口

- 可以同时连接多个串口
- 每个串口都有独立的控制界面
- 可以独立查看每个串口的数据
- 可以独立向每个串口发送数据
- 可以独立删除不需要的串口连接

## 技术特性

### 多串口管理器

- 支持同时管理多个串口连接
- 每个串口有独立的接收线程
- 每个串口有独立的自动发送定时器
- 支持独立的统计信息

### 信号机制

- 使用PyQt6的信号槽机制
- 支持异步数据处理
- 支持跨窗口数据传递

### 错误处理

- 完善的错误处理机制
- 串口连接失败时的错误提示
- 数据发送失败时的错误处理

## 文件结构

```
DataCenter/
├── core/
│   ├── multi_serial_manager.py    # 多串口管理器
│   └── serial_handler.py          # 单串口处理器（保留兼容性）
├── ui/
│   ├── serial_info_widget.py      # 串口信息组件
│   ├── received_data_window.py    # 接收信息窗口
│   ├── send_data_window.py        # 发送数据窗口
│   └── config_page.py             # 配置页面（已更新）
└── main.py                        # 主程序（已更新）
```

## 兼容性

- 保持与原有单串口功能的兼容性
- 原有的数据页面功能仍然可用
- 新增功能不影响现有功能

## 注意事项

1. 每个串口都会占用系统资源，建议不要同时连接过多串口
2. 自动发送功能会持续占用CPU资源，使用完毕后请及时停止
3. 接收数据窗口会持续更新，如果数据量很大可能影响性能
4. 建议在发送大量数据时使用十六进制模式以确保数据准确性 